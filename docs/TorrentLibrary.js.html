<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TorrentLibrary.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="TorrentLibrary.html">TorrentLibrary</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="TorrentLibrary.html#.listVideosExtension">listVideosExtension</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="TorrentLibrary.html#addNewPath">addNewPath</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="TorrentLibrary.html#hasPathsProvidedByUser">hasPathsProvidedByUser</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="TorrentLibrary.html#scan">scan</a></span></li><li class="nav-heading">Externals</li><li class="nav-heading"><span class="nav-item-type type-external">E</span><span class="nav-item-name"><a href="external-Promise.html">Promise</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#defaultPath">defaultPath</a></span></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#paths">paths</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">TorrentLibrary.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * module for exploring directories
 * @see {@link https://nspragg.github.io/filehound/}
 */
import FileHound  from 'filehound';

/**
 * module fs from node
 * @see {@link https://nodejs.org/api/fs.html}
 */
import {access} from 'fs';

/**
 * A promise object provided by the bluebird promise library.
 * @external Promise
 * @see {@link http://bluebirdjs.com/docs/api-reference.html}
 */
import PromiseLib from 'bluebird'

/**
 * List of video file extensions
 * @see {@link https://github.com/sindresorhus/video-extensions}
 */
import videosExtension from 'video-extensions';

import {
    EventEmitter
} from 'events';

/**
 * Class representing the TorrentLibrary
 * @extends EventEmitter
 * @see {@link https://nodejs.org/api/events.html#events_class_eventemitter } for further information.
 */
class TorrentLibrary extends EventEmitter {

    /**
     * Create a TorrentLibrary
     */
    constructor() {
        super();
        /**
         * just an easy way to scan the current directory path, if not other paths provided
         * @member  {string} defaultPath
         * @default the directory from which you invoked the node command
         */
        this.defaultPath = process.cwd();
        /**
         * the paths where we are looking the media files
         * @member {String[]} paths
         * @default []
         */
        this.paths = [];
    }

    /**
     * Provides the array of files extensions considered to be media extensions
     * @return {string[]} array of files extensions
     * @since 0.0.0
     * @example
     * // Returns [..., 'webm', 'wmv']
     * TorrentLibrary.listVideosExtension()
     * @static
     */
    static listVideosExtension(){
        return videosExtension;
    }

    /**
     * Add the path(s) to be analyzed by the library if they exist and are readable
     * @param {(string|string[])} paths - A path or an array of paths
     * @since 0.0.0
     * @example
     * // return resolved Promise "All paths were added!"
     * TorrentLibraryInstance.addNewPath("C:\Users\jy95\Desktop\New folder");
     * @return {external:Promise}  On success the promise will be resolved with "All paths were added!"&lt;br>
     * On error the promise will be rejected with an "Missing parameter" if the argument is missing&lt;br>
     * or "Cannot find/read a path" if one of the provided paths doesn't exist or is not readable&lt;br>
     */
    addNewPath(...paths){
        // the user should provide us at lest a path
        if (paths.length === 0)
            return missingParam();

        let that = this;
        return new PromiseLib(function (resolve,reject) {

            return new PromiseLib.map(paths, function (path) {
                // https://nodejs.org/api/fs.html#fs_fs_access_path_mode_callback
                // check if directory exists and is readable
                return access(path, fs.constants.F_OK | fs.constants.R_OK);
            }).then(function () {
                that.paths = [...that.paths, ...paths];
                resolve("All paths were added!");
            }).catch(e => {
                reject("Cannot find/read a path");
            })

        });

    }

    /**
     * Tell us if the user has provided us paths
     * @since 0.0.0
     * @returns {boolean}
     */
    hasPathsProvidedByUser(){
        return this.paths.length === 0;
    }

    /**
     * @todo Write the documentation.
     * @todo Implement this function.
     */
    scan(){

        const files = FileHound.create()
            .paths( (this.paths.length === 0) ? this.defaultPath : this.paths)
            .ext(videosExtension)
            .find();

        return files;

    }

}

// rejected promise when someone doesn't provide
function missingParam() {
    return new PromiseLib(function (resolve,reject) {
       reject("Missing parameter");
    });
}

export default TorrentLibrary;</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.4</a> on Thu Aug 24 2017 22:58:45 GMT+0200 (Romance Daylight Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
